<script setup lang="ts">
import { ref, onMounted } from 'vue'
import { clientSendPercent } from '@/client'

const text = ref(null);
let textEl;
let textHeight = 0;

onMounted(() => {
  textEl = text.value;
  textHeight = textEl.getBoundingClientRect().height;
});

const vScroll = {
  mounted: (el, binding) => { 
    window.addEventListener('scroll', binding.value);
  },
  beforeUnmount(el, binding) {
    window.removeEventListener('scroll', binding.value);
  },
}

const scrollHandler = () => {
    console.log('SCROLL', window.scrollY / textHeight);
    clientSendPercent(window.scrollY / textHeight);
}
</script>

<template>
  <main ref="text" v-scroll="scrollHandler">
    <p>
      Lorem ipsum dolor sit amet consectetur adipisicing elit. Laborum odio, minus doloribus amet atque cumque aspernatur eligendi! Vitae unde, veritatis numquam, neque rerum sint eum aspernatur ut eligendi cupiditate quos quas temporibus animi esse ipsum. Eum quod, ullam doloribus deserunt, itaque quaerat magnam laudantium id cumque quasi delectus optio earum ea et non ad quam. Tempore, harum numquam repellendus quo dignissimos velit earum, rem inventore veritatis corporis ipsa aperiam. Quae voluptatibus ad unde, aspernatur obcaecati repudiandae quo labore earum nostrum eveniet libero iusto est atque ducimus eius dolorum, tempora, dolores consequatur aperiam officiis nobis? Accusantium, repellat enim sed blanditiis incidunt voluptatem. Nemo eos sunt repellat corporis rerum ab labore odit. Quasi officia assumenda molestiae similique laboriosam ratione quae placeat libero vitae tempore, sunt aliquam in at, tempora reiciendis ducimus, incidunt facere pariatur id autem voluptatum sint. Veritatis ea vero perferendis non quam saepe nisi ducimus! Temporibus commodi exercitationem repellendus quas nostrum est voluptatum. Magni rerum, molestiae fugit dolor praesentium sed corrupti consequuntur laborum dolores iste voluptas nobis eaque officia aliquam obcaecati nam explicabo, reiciendis voluptates aspernatur ea sit eveniet. Beatae quo, consequatur harum debitis totam a laboriosam nemo, ratione excepturi ullam itaque, velit laudantium pariatur dolorum quibusdam officiis! Expedita asperiores repellendus veritatis incidunt quam, consequuntur nostrum facilis, eos soluta dicta repellat necessitatibus cupiditate blanditiis eius cum ducimus aut? Non quas dolor voluptate quaerat veniam suscipit inventore necessitatibus magnam corrupti officia, libero distinctio saepe minus aut debitis nesciunt quos ipsum obcaecati facilis quidem molestias expedita perferendis. Pariatur totam inventore voluptatum natus, accusamus, expedita repudiandae perspiciatis nobis provident eius sunt at commodi impedit beatae nihil corrupti debitis qui excepturi ullam iste officia rem nostrum. Asperiores assumenda architecto quia dolore facilis cupiditate? Sapiente distinctio expedita perferendis, optio quae modi ipsum consectetur necessitatibus eius quia quod quos enim, ullam quidem doloribus dolorem? Ab minus eligendi laudantium cum! Maiores distinctio fuga voluptas, aliquam repellat adipisci incidunt sapiente quae nostrum alias. Cumque accusamus deleniti nulla repellat eveniet vitae magnam, dolorum sequi, facilis voluptate quam! Enim recusandae dolor non numquam nobis dicta hic unde possimus nostrum rerum. Error quae aliquid autem nihil, expedita debitis illo obcaecati? Iste inventore sint eius rem fuga omnis magnam obcaecati corporis pariatur illo consectetur excepturi, alias molestias quas repudiandae impedit fugit, minima porro itaque quibusdam. Eaque molestias beatae, minima exercitationem reiciendis, odio esse facilis saepe consequuntur voluptatibus in rem! Repellendus suscipit quaerat rem veritatis numquam minima aliquam deserunt, quasi quisquam aliquid a repellat cupiditate, enim rerum debitis perspiciatis nostrum laborum fugiat voluptatum similique mollitia atque vel voluptas est! Pariatur voluptas inventore, aperiam dolor magnam a labore, quos beatae magni dignissimos veritatis ad nostrum possimus sunt cum. Officia explicabo est ad magni rem expedita eligendi repellat repudiandae non veritatis eaque iste voluptatem quo nobis, aliquid commodi dicta quisquam, rerum sed enim ratione, ullam beatae qui? Facilis voluptas tempora distinctio, facere assumenda obcaecati at aliquid officia enim delectus doloremque beatae, maxime repellendus in, quis asperiores amet magni aliquam veritatis dolorum nemo perspiciatis ex voluptatibus dolore! Reprehenderit consequuntur assumenda quam hic autem ipsa at omnis quo deleniti id aliquam in dicta aperiam praesentium, officia iusto perferendis possimus quae rerum amet quasi. Est aperiam repellat dignissimos voluptates exercitationem alias optio dolores vitae dolore, officiis nam ab totam excepturi enim consectetur et. Veritatis voluptatibus laudantium repellendus? Nobis, obcaecati blanditiis voluptate cumque placeat ratione culpa illum nostrum molestiae id dolor, itaque sint excepturi omnis, voluptatum inventore. Magnam reiciendis eaque quam iusto sit architecto eveniet corporis fuga accusantium voluptas non praesentium cupiditate illum repudiandae vitae autem, soluta ad sapiente earum aspernatur nihil quisquam quos ullam! Provident nam impedit veniam alias! Aliquam iure sapiente ipsam hic tempore dignissimos assumenda doloribus rerum quo obcaecati mollitia ducimus, minima vitae ab expedita pariatur nihil culpa necessitatibus illo sed dicta perferendis numquam itaque incidunt? Cupiditate, delectus a? Doloribus sunt doloremque animi perspiciatis, ipsa reprehenderit id consectetur fuga repellat a minima dolorum distinctio illo eligendi eaque corrupti cum earum officiis dolorem vel repudiandae adipisci quidem at. Repellendus explicabo dolore quam vel quaerat, quae dignissimos, ipsa ullam unde fugiat qui consequatur enim et eligendi, sunt deleniti iusto rerum! A incidunt neque aperiam aut laborum temporibus provident ipsa, dolor voluptates nihil minima nobis iusto quasi sequi! Perferendis similique dolore ullam nemo, repellat ut quasi asperiores? Neque omnis asperiores officiis, nemo ad sed quaerat consequatur, ab sapiente maxime esse commodi ex praesentium suscipit. Sapiente quibusdam quo reprehenderit, voluptatem atque libero minus eos nemo dignissimos adipisci ducimus, necessitatibus recusandae corporis sunt possimus laborum? Blanditiis dolorum dolore, itaque harum quas est eaque doloribus nulla aliquid at corporis beatae tenetur eligendi mollitia quae architecto, omnis natus impedit amet saepe molestiae. Fugiat, eum magnam architecto ad ea velit assumenda culpa excepturi, numquam doloribus labore! Commodi deserunt impedit voluptate, tempore provident cupiditate eum tempora, neque sit, atque esse repudiandae? Natus quia suscipit, ea possimus recusandae quaerat, sint eos magni nihil nostrum facere praesentium iusto error laborum eveniet ut voluptates sequi minima! Pariatur natus maiores modi ab quisquam velit nulla, minima odit illum minus asperiores! Porro totam atque tempora dolore nobis expedita enim aspernatur itaque repellat error? Error ipsa tempora autem praesentium consequatur minima corrupti ullam, repellat itaque ipsam. Nulla cupiditate nam in? Provident quo voluptates reiciendis tempora eligendi magnam illum omnis? Consectetur autem natus obcaecati, sequi saepe, repellat molestiae alias odit inventore, aspernatur excepturi odio consequuntur labore? Molestiae, iure maiores laudantium dolorum enim vero iste? Quos explicabo maiores officiis. Provident ex, accusamus totam architecto aut, molestiae quod dignissimos suscipit voluptates exercitationem omnis asperiores animi ipsum aperiam facere ullam et cum sint, quis nemo voluptas est iusto soluta! Vero vitae accusantium temporibus doloremque sint rerum neque ipsam quisquam pariatur voluptatum optio, qui nam cum quae tempore laboriosam voluptatibus iusto atque perspiciatis laudantium ducimus officiis doloribus alias! Dicta quod neque, distinctio consectetur possimus nisi ea. Rerum corrupti possimus dolore! Quam nulla facere dignissimos aspernatur animi neque sit similique, illo doloribus, molestias vitae qui! Voluptatum omnis similique eaque aspernatur dolor quasi molestiae rerum dolorum accusantium dignissimos, inventore maiores! Dolorem voluptate autem repudiandae mollitia pariatur minus! Nesciunt enim necessitatibus magni labore tempora quas maiores aspernatur consequuntur, quibusdam quidem debitis modi quos esse nostrum consectetur ipsum repellendus! Ipsa explicabo nesciunt quas porro ipsum fugiat harum magni dicta, repudiandae odio itaque libero error temporibus eum vitae ad! Dicta atque asperiores reiciendis facilis nobis. Voluptas quo voluptatem non itaque corporis excepturi delectus veritatis repellendus quibusdam recusandae, error molestiae, animi mollitia, nesciunt veniam accusamus ipsam. Facere quia nobis sint ipsam unde molestiae officia mollitia sequi nulla consequuntur veniam explicabo similique non possimus nesciunt soluta eius, minus in. Praesentium asperiores sapiente illo unde tenetur, totam id! Delectus, ipsa ex. Accusamus id quis nisi quae. Ab numquam aspernatur hic veritatis fugiat dolorum molestias, exercitationem esse maxime vel similique earum tempore facere quis consectetur, perspiciatis itaque fuga? Animi in dolores voluptatem laborum ipsa voluptatibus, veritatis aspernatur exercitationem porro, provident consequatur, assumenda rem aut consequuntur blanditiis recusandae? Ut dolores possimus necessitatibus cum aut velit placeat? Obcaecati ipsam voluptatibus, tenetur amet optio nesciunt in dicta at quod exercitationem ullam et beatae corrupti, recusandae dolorem ratione ab non quidem, quisquam quia dolor praesentium! Libero saepe nulla aspernatur nobis iure molestiae natus asperiores rem et incidunt corrupti doloremque, minus veniam quo dignissimos quisquam perspiciatis illo accusantium. Incidunt doloribus blanditiis iusto praesentium eaque corrupti voluptas officia maiores, magnam non quasi aperiam repudiandae distinctio dolores officiis, rerum explicabo molestiae temporibus accusantium atque nobis culpa facere placeat? Molestias molestiae illum saepe distinctio vel iusto, voluptates aliquam blanditiis numquam aliquid? Temporibus ullam modi suscipit illum enim perferendis delectus quis ea reprehenderit assumenda. Ipsum reprehenderit ipsam impedit ducimus excepturi consequatur numquam repellendus, dolor culpa iure, totam ratione praesentium similique nulla, tempore iste atque ab deleniti! Nam sit eum quisquam quos. Quod iusto nemo temporibus suscipit corporis deleniti distinctio blanditiis deserunt perferendis. Quibusdam, labore repudiandae totam voluptas atque dignissimos ipsum sint nesciunt cum, hic dolores cupiditate quos aspernatur facilis optio delectus sequi quam iste laborum architecto. Repellat ducimus earum at repudiandae dolor aspernatur nostrum fugiat, magni, dignissimos quos possimus distinctio veritatis officiis corrupti culpa quisquam nam voluptate quod minima eveniet doloribus! Fugiat at culpa sint accusantium quibusdam non quod consequatur, aliquid tenetur sit inventore totam modi blanditiis excepturi incidunt ipsum eius accusamus? Doloribus, qui dolores? Incidunt aliquam velit vitae, molestiae repellendus, facere voluptatibus recusandae in tempora magni ratione eaque necessitatibus nobis neque deleniti accusantium voluptatum et quae! Nisi sed pariatur perspiciatis, dolorem et accusantium deserunt maxime ipsam alias officiis, repellendus ipsum accusamus magnam aliquam, tenetur non. Velit provident dolorem, inventore incidunt voluptatum eveniet expedita sapiente sit enim minus nihil dolores doloremque vel dignissimos optio quo. Culpa sunt cumque beatae autem quae delectus distinctio, nesciunt, consequuntur sed ut blanditiis dicta id maiores at, necessitatibus quo enim! Facere cupiditate quas porro molestiae aliquid doloremque aperiam quos distinctio, delectus quis ad neque ex, architecto debitis. Nulla ratione doloribus adipisci earum molestias neque doloremque eligendi dicta mollitia, ipsum iste placeat quisquam ipsa sapiente impedit aut ex aperiam suscipit eum in aspernatur voluptate voluptates aliquid! Laudantium eaque tenetur voluptates id aspernatur distinctio natus vero, pariatur ab ratione quae corporis! Quam mollitia accusamus repudiandae ducimus sequi fugiat amet velit eum illo facere? Explicabo eos facere exercitationem nihil quod molestias iste voluptate dolorem molestiae et voluptatibus animi quasi aliquam, quo optio aut autem enim temporibus est eum quaerat excepturi neque culpa! Quidem, sapiente id voluptates consequatur quae officiis obcaecati dolorem quibusdam totam optio deserunt aliquam sed minima dolor tempora excepturi sunt iure commodi fugit repellat facere, ex atque illum. Quis doloremque eveniet voluptatem distinctio inventore aut omnis, ab accusamus voluptate iusto odit. Officia doloremque ratione, cupiditate consequuntur autem itaque aliquam expedita nobis assumenda eaque, dicta vero quam placeat debitis soluta mollitia, accusamus suscipit repellat labore dolores quae alias nulla! Distinctio, officiis. Animi eligendi reiciendis at sunt maxime itaque voluptate ad perferendis eius quia similique rerum cum deserunt illo ut illum pariatur placeat ab cupiditate sapiente, magnam asperiores exercitationem nesciunt impedit. Necessitatibus saepe perferendis dolorem quas facere. Amet molestias maiores a reiciendis repellendus expedita. Sapiente, repudiandae minima quia eaque veritatis recusandae impedit similique. Eveniet suscipit temporibus est laboriosam in deserunt tempora exercitationem distinctio, neque omnis fuga excepturi reprehenderit ipsa sit! Ea consectetur pariatur vitae porro beatae voluptatum vero dolore tempore! Nulla, enim omnis sapiente quis, modi unde sequi aspernatur facere ea rem sint reprehenderit doloremque numquam veritatis itaque, quasi deleniti aut minus provident quam odit iste sunt natus mollitia! Ipsum laborum odit, eos in sit similique necessitatibus? Assumenda ipsa porro dolorem aspernatur corrupti, tempora, quasi sint hic atque, natus eveniet placeat eum harum. Veniam, cum. Consequatur vel vitae a explicabo, quibusdam porro atque magni ea sequi tenetur accusamus aliquid totam laborum animi ex veritatis autem quos aut deserunt dolor exercitationem molestiae enim. Consequuntur totam corrupti illum laborum, pariatur, magni error eaque porro quasi sed sunt natus officia accusamus vel nemo nisi? At voluptas dicta, amet fugit hic alias nulla rerum sunt asperiores, repellendus corporis aspernatur sint aut? Tempora distinctio, aut repellat rem ratione impedit? Tempora ab sunt at corrupti fugit harum, eum deleniti aliquid. Atque incidunt ducimus obcaecati veritatis ab esse itaque nostrum officiis tenetur labore, asperiores doloribus repellendus eaque mollitia aut suscipit corrupti cumque laboriosam molestiae eius? Nisi amet incidunt similique praesentium accusamus aliquid, voluptatem velit cum officiis minima voluptates porro vero unde neque quae excepturi molestiae exercitationem. Modi, veniam? Necessitatibus pariatur distinctio quod culpa eos quam illo molestiae possimus, ea delectus cum velit iste dolorem provident omnis tempore debitis laudantium asperiores quidem sit odit dolorum exercitationem nam facere? Neque quo, doloribus cumque enim possimus nulla earum, temporibus repudiandae rem rerum asperiores pariatur fugit, quidem in quaerat? Mollitia explicabo neque accusantium praesentium nesciunt sapiente, ullam enim perferendis earum cum eos fugiat! Totam atque velit nihil quasi illo? Facere at suscipit minus praesentium iure possimus. Aliquam minus fugiat magni hic vitae deleniti distinctio perspiciatis provident consequatur. Optio, quasi quos! Laborum amet necessitatibus cum eum dolorum minus omnis sint illum accusantium mollitia, doloribus aliquid laboriosam inventore odit, nesciunt ut! Ad doloremque minima velit placeat cumque dignissimos assumenda ex porro inventore obcaecati soluta eveniet totam, magni iusto exercitationem possimus, ducimus optio nisi magnam quae odio? Alias commodi optio atque, ex quae cupiditate eligendi necessitatibus?
    </p>
  </main>
</template>

<style scoped>
main {
  padding: var(--padding-common);
  padding-top: calc(var(--header-height) + var(--padding-common));
}
</style>
